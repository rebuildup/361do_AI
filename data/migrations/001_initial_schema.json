{
  "version": "001_initial_schema",
  "description": "Initial database schema creation",
  "sql": [
    "\n                CREATE TABLE agent_states (\n                    session_id VARCHAR(36) PRIMARY KEY,\n                    user_id VARCHAR(255),\n                    current_prompt_version VARCHAR(50) NOT NULL DEFAULT '1.0.0',\n                    learning_epoch INTEGER NOT NULL DEFAULT 0,\n                    total_interactions INTEGER NOT NULL DEFAULT 0,\n                    reward_score FLOAT NOT NULL DEFAULT 0.0,\n                    evolution_generation INTEGER NOT NULL DEFAULT 0,\n                    last_activity TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    performance_metrics JSON,\n                    is_active BOOLEAN NOT NULL DEFAULT 1,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n                )\n                ",
    "\n                CREATE TABLE prompt_templates (\n                    version VARCHAR(50) PRIMARY KEY,\n                    content TEXT NOT NULL,\n                    metadata JSON,\n                    performance_score FLOAT NOT NULL DEFAULT 0.0,\n                    usage_count INTEGER NOT NULL DEFAULT 0,\n                    is_active BOOLEAN NOT NULL DEFAULT 1,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    last_modified TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n                )\n                ",
    "\n                CREATE TABLE tuning_data (\n                    id VARCHAR(36) PRIMARY KEY,\n                    content TEXT NOT NULL,\n                    data_type VARCHAR(50) NOT NULL,\n                    quality_score FLOAT NOT NULL DEFAULT 0.0,\n                    usage_count INTEGER NOT NULL DEFAULT 0,\n                    tags JSON,\n                    metadata JSON,\n                    is_active BOOLEAN NOT NULL DEFAULT 1,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n                )\n                ",
    "\n                CREATE TABLE evolution_candidates (\n                    id VARCHAR(36) PRIMARY KEY,\n                    parent_ids JSON,\n                    prompt_template_version VARCHAR(50) NOT NULL,\n                    fitness_score FLOAT NOT NULL DEFAULT 0.0,\n                    generation INTEGER NOT NULL DEFAULT 0,\n                    evaluation_metrics JSON,\n                    is_selected BOOLEAN NOT NULL DEFAULT 0,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    evaluated_at TIMESTAMP,\n                    FOREIGN KEY (prompt_template_version) REFERENCES prompt_templates(version)\n                )\n                ",
    "\n                CREATE TABLE evolution_tuning_data (\n                    evolution_candidate_id VARCHAR(36),\n                    tuning_data_id VARCHAR(36),\n                    weight FLOAT NOT NULL DEFAULT 1.0,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    PRIMARY KEY (evolution_candidate_id, tuning_data_id),\n                    FOREIGN KEY (evolution_candidate_id) REFERENCES evolution_candidates(id),\n                    FOREIGN KEY (tuning_data_id) REFERENCES tuning_data(id)\n                )\n                ",
    "\n                CREATE TABLE reward_signals (\n                    id VARCHAR(36) PRIMARY KEY,\n                    interaction_id VARCHAR(36) NOT NULL,\n                    reward_type VARCHAR(50) NOT NULL,\n                    value FLOAT NOT NULL,\n                    context JSON,\n                    timestamp TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    FOREIGN KEY (interaction_id) REFERENCES interactions(id)\n                )\n                ",
    "\n                CREATE TABLE interactions (\n                    id VARCHAR(36) PRIMARY KEY,\n                    session_id VARCHAR(36) NOT NULL,\n                    user_input TEXT NOT NULL,\n                    agent_response TEXT NOT NULL,\n                    reasoning_steps JSON,\n                    tool_usage JSON,\n                    processing_time FLOAT,\n                    quality_score FLOAT,\n                    metadata JSON,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    FOREIGN KEY (session_id) REFERENCES agent_states(session_id)\n                )\n                ",
    "\n                CREATE TABLE learning_sessions (\n                    id VARCHAR(36) PRIMARY KEY,\n                    session_id VARCHAR(36) NOT NULL,\n                    session_type VARCHAR(50) NOT NULL,\n                    status VARCHAR(20) NOT NULL DEFAULT 'pending',\n                    parameters JSON,\n                    results JSON,\n                    metrics JSON,\n                    started_at TIMESTAMP,\n                    completed_at TIMESTAMP,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    FOREIGN KEY (session_id) REFERENCES agent_states(session_id)\n                )\n                ",
    "\n                CREATE TABLE system_metrics (\n                    id VARCHAR(36) PRIMARY KEY,\n                    metric_name VARCHAR(100) NOT NULL,\n                    metric_value FLOAT NOT NULL,\n                    metric_type VARCHAR(50) NOT NULL,\n                    tags JSON,\n                    timestamp TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    UNIQUE(metric_name, timestamp)\n                )\n                ",
    "\n                CREATE TABLE configurations (\n                    id VARCHAR(36) PRIMARY KEY,\n                    config_key VARCHAR(100) NOT NULL UNIQUE,\n                    config_value TEXT NOT NULL,\n                    config_type VARCHAR(50) NOT NULL,\n                    description TEXT,\n                    is_active BOOLEAN NOT NULL DEFAULT 1,\n                    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n                    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n                )\n                "
  ],
  "rollback_sql": [
    "DROP TABLE IF EXISTS configurations",
    "DROP TABLE IF EXISTS system_metrics",
    "DROP TABLE IF EXISTS learning_sessions",
    "DROP TABLE IF EXISTS interactions",
    "DROP TABLE IF EXISTS reward_signals",
    "DROP TABLE IF EXISTS evolution_tuning_data",
    "DROP TABLE IF EXISTS evolution_candidates",
    "DROP TABLE IF EXISTS tuning_data",
    "DROP TABLE IF EXISTS prompt_templates",
    "DROP TABLE IF EXISTS agent_states"
  ],
  "checksum": "initial_schema_v1"
}